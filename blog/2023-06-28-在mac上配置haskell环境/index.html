<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  
    
    
      <link href="/css/fonts.css" rel="stylesheet" type="text/css">
    
  

  
  <title>在Mac上配置Haskell环境</title>

  
  
  <link rel="stylesheet" href="/css/hugo-octopress.css">

  
  

  
    <link rel="stylesheet" href="/css/fork-awesome.min.css">
  

  
  
    <link href="https://forceoflife.cn/favicon.png" rel="icon">
  

  
  

  <meta name="description" content="" />
  <meta name="keywords" content="">
  <meta name="author" content="生活之力">

  
  <meta name="generator" content="Hugo 0.118.2">

  
  

  
  



</head>
<body>


<header role="banner">
<hgroup>
  
  <h1><a href="https://forceoflife.cn/">为生活</a></h1>
    <h2>生活是人生唯一的主旋律，不是工作，不是学习，更不是代码</h2>
</hgroup></header>


<nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigate…</option>
      
        <option value="https://forceoflife.cn/">» 首页</option>
      
        <option value="https://forceoflife.cn/categories">» 分类</option>
      
        <option value="https://forceoflife.cn/book/">» 书籍推荐</option>
      
  </select>
</fieldset>


<ul class="main-navigation">
  
  
    
      <li><a href="https://forceoflife.cn/" title="首页">首页</a></li>
    
  
    
      <li><a href="https://forceoflife.cn/categories" title="分类"  rel="noopener noreferrer">分类</a></li>
    
  
    
      <li><a href="https://forceoflife.cn/book/" title="书籍推荐"  rel="noopener noreferrer">书籍推荐</a></li>
    
  
</ul>

<ul class="subscription">
  
    
        <a href="https://forceoflife.cn/index.xml" target="_blank" type="application/rss+xml" title="RSS" rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a>
    
  
</ul>


  <form action="https://www.google.com/search" method="get" target="_blank" rel="noopener noreferrer">
    <fieldset role="search">
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      <input type="hidden" name="q" value="site:https://forceoflife.cn/" />
    </fieldset>
  </form>

</nav>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">

        
        

<header>
  <p class="meta">Jun 28, 2023
     - 1 minute read 
    

    
    
      - <a class="label" href="https://forceoflife.cn/categories/%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba/">环境搭建 </a>
    
  </p>
  <h1 class="entry-title">
    <a href="https://forceoflife.cn/blog/2023-06-28-%E5%9C%A8mac%E4%B8%8A%E9%85%8D%E7%BD%AEhaskell%E7%8E%AF%E5%A2%83/">在Mac上配置Haskell环境</a>
  </h1>
</header>


        <div class="entry-content">
          
          
          
            <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#安装-haskell">安装 Haskell</a></li>
        <li><a href="#编辑器配置">编辑器配置</a></li>
      </ul>
    </li>
  </ul>
</nav>
          
          <blockquote>
<p>这篇博客将介绍如何在<strong>中国</strong>安装、配置 Mac 的 Haskell 环境和编辑器的高亮、补全，其中编辑器包括 Vim/Neovim、Visual Studio Code。</p>
</blockquote>
<h2 id="安装-haskell">安装 Haskell</h2>
<blockquote>
<p>本文将带你安装 GHCup、GHC、Cabal。由于笔者写这篇文章时还是 Haskell 的初学者，所以没有办法细致的分析各种工具的优劣，故选择目前相对流行、配置简单的工具。</p>
</blockquote>
<p>要安装 Haskell，首先要打开一个 terminal，之后的操作都会基于 terminal 来完成。</p>
<p>第一步我们要安装 GHCup，由于这个软件比较新，所以较少有镜像，这里我们选择
<a href="https://mirrors.ustc.edu.cn/help/ghcup.html" target="_blank" rel="noopener">中科大的镜像网站</a>。但是由于 GHCup 在安装 Cabal 时会下载一个文件，所以我们必须提前替换 hackage 源，否则将无法正常安装。换源方法如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#586e75"># 第一步在家目录下创建一个 .cabal 文件夹</span>
</span></span><span style="display:flex;"><span><span style="color:#b58900">cd</span> ~ <span style="color:#719e07">&amp;&amp;</span> mkdir .cabal
</span></span><span style="display:flex;"><span><span style="color:#586e75"># 第二步创建并编辑一个 config 文件</span>
</span></span><span style="display:flex;"><span>vi .cabal/config
</span></span></code></pre></div><p>这里我选择用 vim，你可以用 nano，vscode 等等编辑器，不会有任何影响，<del>当然，我不推荐你使用 emacs</del>。然后将如下内容粘贴进去，保存退出：</p>
<pre tabindex="0"><code>repository mirrors.ustc.edu.cn
  url: https://mirrors.ustc.edu.cn/hackage/
  secure: True
</code></pre><p>之后就可以在终端执行命令了：</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>curl --proto <span style="color:#2aa198">&#39;=https&#39;</span> --tlsv1.2 -sSf https://mirrors.ustc.edu.cn/ghcup/sh/bootstrap-haskell | <span style="color:#268bd2">BOOTSTRAP_HASKELL_YAML</span><span style="color:#719e07">=</span>https://mirrors.ustc.edu.cn/ghcup/ghcup-metadata/ghcup-0.0.7.yaml sh
</span></span></code></pre></div><p>接下来你会看到这样的界面：</p>
<p><img src="https://cdn.jsdelivr.net/gh/zzxdyf1314/mycloudimg@master/image-20230702042402797.png" alt="image-20230702042402797"></p>
<p><strong>请仔细阅读所有提示，如果你不知道该做什么，就照我的选择去做：</strong></p>
<ol>
<li>是否自动将 ghcup 目录自动加入 PATH 直接回车</li>
<li>是否安装 haskell 的 lsp
<ul>
<li>如果你想使用 vscode 或 vim 等编辑器来补全、高亮、提示 Haskell 代码，就输入 Y；</li>
</ul>
</li>
<li>是否安装 Stack，输入 N，不安装。</li>
</ol>
<p>之后的选项都直接回车，就完成了 GHCup 的安装，这里你需要设置当前 shell 的 PATH：</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#b58900">source</span> ~/.ghcup/env
</span></span></code></pre></div><p>如果你不想这样做，也可以直接重启你的 shell。</p>
<p>这时你的 Haskell 环境已经安装完成了，可以简单测试一下：</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ghc --version
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cabal --version
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ghci
</span></span><span style="display:flex;"><span><span style="color:#586e75"># 输入 :q 以退出 ghci</span>
</span></span></code></pre></div><p>接下来的步骤是配置 GHCup 的源</p>
<p>编辑 <code>~/.ghcup/config.yaml</code>文件，向其中添加：</p>
<pre tabindex="0"><code>url-source:
    OwnSource: https://mirrors.ustc.edu.cn/ghcup/ghcup-metadata/ghcup-0.0.7.yaml
</code></pre><h2 id="编辑器配置">编辑器配置</h2>
<p>如果你想在 Vim/Neovim 上使用 HLS 来完成高亮、补全、提示、报错的话，你需要安装 
<a href="https://github.com/neoclide/coc.nvim" target="_blank" rel="noopener">Coc.nvim</a>，并安装<code>coc-hls</code>插件，可以直接在 vim 的 command 模式下输入<code>:CocInstall coc-hls</code>，之后就可以正常使用了（一定要保证你安装了 HLS）。</p>
<p>在 vscode 上搜索 Haskell，安装同名插件即可。</p>
<p>不管是在 vim 还是 vscode 上都可能出现一种情况，插件提示说找不到对应版本的 HLS，一般来说问题出在你安装的 GHC 还不支持你安装的 HLS，可以在终端输入：</p>
<pre tabindex="0"><code>ghcup tui
</code></pre><p>进入 ghcup 的 ui 界面：</p>
<p><img src="https://cdn.jsdelivr.net/gh/zzxdyf1314/mycloudimg@master/image-20230702043610766.png" alt="image-20230702043610766"></p>
<p>一定要保证你安装的 GHC 后面标有 hls-powered，你可以按上下键移动到对应的 GHC 版本上按<code>i</code>安装或按<code>u</code>卸载。同样的，你也可以安装或卸载其他的工具。</p>
<p>如果你是从这个界面安装的其他版本的 GHC，并卸掉了之前安装的，那么你需要替换掉原本的 ghc 文件和 ghci 文件，你可以在重启 shell 后发现 ghc 和 ghci 命令不存在或是还是原来的版本，这时你需要更新这两个文件。</p>
<p>ghc 和 ghci 的默认路径在家目录下的<code>.ghcup/bin/</code>下，是软连接到.ghcup/ghc/version code/bin/`下的文件，我们要做的就是重新软连接：</p>
<pre tabindex="0"><code>ln -s ~/.ghcup/ghc/verison code/bin ghci ~/.ghcup/bin/ghci
ln -s ~/.ghcup/ghc/verison code/bin ghc ~/.ghcup/bin/ghc
</code></pre><p>之后重启 shell/vscode，就会发现你的 HLS 已经可以运行了。</p>
<blockquote>
<p>如果最开始有短暂的卡顿，是 HLS 正在启动，稍等即可。</p>
</blockquote>
        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn">生活之力</span></span>
    
    <time>Jun 28, 2023</time>
    
      <span class="categories">
        Tags:
        
          <a class="category" href="https://forceoflife.cn/tags/%e6%8a%80%e6%9c%af">技术</a>  <a class="category" href="https://forceoflife.cn/tags/haskell">Haskell</a>  
    
    </span>
  </p>

  

  <p class="meta">
    
        <a class="basic-alignment left" href="https://forceoflife.cn/blog/2023-06-24-%E8%81%8A%E8%81%8A%E6%9C%80%E8%BF%91/" title="聊聊最近">聊聊最近</a>
    

    
      <a class="basic-alignment right" href="https://forceoflife.cn/blog/2023-06-30-%E6%88%91%E5%9C%A8%E5%81%9A%E4%BB%80%E4%B9%88%E6%9C%AA%E6%9D%A5%E6%88%91%E8%A6%81%E5%81%9A%E4%BB%80%E4%B9%88/" title="我在做什么,未来我要做什么">我在做什么,未来我要做什么</a>
    
  </p>
  
</footer>

      </article>
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    
      <h1>简短的自我介绍</h1>
    

    <p>
      
        <p>我是生活之力，一个热爱生活和文学的程序员。</p>
<p>我喜欢计算机底层原理，但更喜欢分享文学和生活。</p>
<p>如果想联系我的话，欢迎给我发邮件：<!-- raw HTML omitted -->
<a href="mailto:Zhixiao-Zhang@outlook.com">Zhixiao-Zhang@outlook.com</a><!-- raw HTML omitted --></p>
<p>点击
<a href="/about/">关于我</a> 来了解更多吧</p>

      
    </p>
  </section>

  
  



<ul class="sidebar-nav">
  <li class="sidebar-nav-item">
    <a target="_blank" rel="noopener noreferrer" href="https://github.com/forceofsystem" title="https://github.com/forceofsystem"><i class="fa fa-github fa-3x"></i></a>
    
    
    
    
    
    
    <a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/users/19515551/zzxdyf" title="https://stackoverflow.com/users/19515551/zzxdyf"><i class="fa fa-stack-overflow fa-3x"></i></a>
    
    
    
    

  
  
  </li>
</ul>

  

  
    
      <section class="odd">
        
          <h1>相关链接</h1>
        
        
          <li>
            <a href="https://forceoflife.cn/categories/%E4%BA%BA%E6%96%87" title="人文" >人文</a>
          </li>
        
          <li>
            <a href="https://forceoflife.cn/categories/%E7%A4%BE%E7%A7%91" title="社科" >社科</a>
          </li>
        
          <li>
            <a href="https://forceoflife.cn/about" title="关于我" >关于我</a>
          </li>
        
      </section>
    
  

  
  
  
    
      <section class="even">
        <h1>最近发布</h1>
        <ul id="recent_posts">
          
          
            
          
            
              <li class="post">
                <a href="/blog/2023-09-09-%E4%BB%8Ehexo%E5%88%B0hugo/">从hexo到hugo</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-08-03-%E5%9B%B4%E7%82%89%E5%A4%9C%E8%AF%9D3%E6%88%91%E5%9C%A8%E6%80%80%E5%BF%B5%E4%BB%80%E4%B9%88/">围炉夜话（3）——我在怀念什么？</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-07-02-%E7%BB%86%E8%AF%BB%E6%88%91%E4%B8%8E%E5%9C%B0%E5%9D%9B/">细读《我与地坛》</a>
              </li>
            
          
            
              <li class="post">
                <a href="/blog/2023-06-30-%E6%88%91%E5%9C%A8%E5%81%9A%E4%BB%80%E4%B9%88%E6%9C%AA%E6%9D%A5%E6%88%91%E8%A6%81%E5%81%9A%E4%BB%80%E4%B9%88/">我在做什么,未来我要做什么</a>
              </li>
            
          
        </ul>
      </section>
    
  
</aside>

  </div>
</div>

    <footer role="contentinfo">
      <p>Copyright &copy; 2023 生活之力 - <a href="https://forceoflife.cn/license/">License</a> -
        <span class="credit">Powered by <a target="_blank" href="https://gohugo.io" rel="noopener noreferrer">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/" rel="noopener noreferrer">Hugo-Octopress</a> theme.
      </p>
    </footer>

    
    



    
    
    

    
  </body>
</html>

