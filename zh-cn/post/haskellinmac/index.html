<!DOCTYPE html>
<html lang="zh-cn">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  
  <meta name="author" content="Patrick">

  
  
  <meta name="description" content="
这篇博客将介绍如何在中国安装、配置 Mac 的 Haskell 环境和编辑器的高亮、补全，其中编辑器包括 Vim/Neovim、Visual Studio Code。
">
  

  
  <link rel="icon" href="https://forceoflife.cn/favicon.jpeg">

  
  
  <meta name="keywords" content=" hugo  latex  theme ">
  

  
  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css"
  integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
  integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js"
  integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: '$$', right: '$$', display: true },
        { left: '\\[', right: '\\]', display: true },
        { left: '$', right: '$', display: false },
        { left: '\\(', right: '\\)', display: false }
      ],
      ignoredTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code', 'option'],
      throwOnError: false
    });
  });
</script>


  

  
  <meta property="og:url" content="https://forceoflife.cn/zh-cn/post/haskellinmac/">
  <meta property="og:site_name" content="生活之力">
  <meta property="og:title" content="在Mac上配置Haskell环境">
  <meta property="og:description" content=" 这篇博客将介绍如何在中国安装、配置 Mac 的 Haskell 环境和编辑器的高亮、补全，其中编辑器包括 Vim/Neovim、Visual Studio Code。">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2023-06-28T18:10:03+08:00">
    <meta property="article:modified_time" content="2023-06-28T18:10:03+08:00">
    <meta property="article:tag" content="Haskell">
    <meta property="article:tag" content="计算机">


  
  <link rel="canonical" href="https://forceoflife.cn/zh-cn/post/haskellinmac/">

  
  
  
  <meta itemprop="name" content="在Mac上配置Haskell环境">
  <meta itemprop="description" content=" 这篇博客将介绍如何在中国安装、配置 Mac 的 Haskell 环境和编辑器的高亮、补全，其中编辑器包括 Vim/Neovim、Visual Studio Code。">
  <meta itemprop="datePublished" content="2023-06-28T18:10:03+08:00">
  <meta itemprop="dateModified" content="2023-06-28T18:10:03+08:00">
  <meta itemprop="wordCount" content="1206">
  <meta itemprop="keywords" content="Haskell,计算机">

  
  <link media="screen" rel="stylesheet" href='https://forceoflife.cn/css/common.css'>
  <link media="screen" rel="stylesheet" href='https://forceoflife.cn/css/content.css'>

  
  
  <title>在Mac上配置Haskell环境 - 生活之力</title>
  

  
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="在Mac上配置Haskell环境">
  <meta name="twitter:description" content=" 这篇博客将介绍如何在中国安装、配置 Mac 的 Haskell 环境和编辑器的高亮、补全，其中编辑器包括 Vim/Neovim、Visual Studio Code。">


  
<link rel="stylesheet" href='https://forceoflife.cn/css/single.css'>

</head>

<body>
  <div id="wrapper">
    <header id="header">
  <h1>
    <a href="https://forceoflife.cn/">生活之力</a>
  </h1>

  <nav>
    
    <span class="nav-bar-item">
      <a class="link" href="/zh-cn/">主页</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/zh-cn/post/">博客</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/zh-cn/about/">关于我</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/zh-cn/index.xml">订阅</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/en">EN</a>
    </span>
    
  </nav>
</header>

    
<main id="main" class="post">
  
  
  <h1>在Mac上配置Haskell环境</h1>
  
  <div>
    <b>Keywords: </b>
    
    <a class="link" href='https://forceoflife.cn/tags/haskell'>#Haskell</a>
    
    <a class="link" href='https://forceoflife.cn/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA'>#计算机</a>
    
  </div>
  
  
  
  <details>
    <summary>
      <b>Table of Contents</b>
    </summary>
    <div class="toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#安装-haskell">安装 Haskell</a></li>
    <li><a href="#编辑器配置">编辑器配置</a></li>
  </ul>
</nav></div>
  </details>
  
  
  <article class="content">
    
    <blockquote>
<p>这篇博客将介绍如何在<strong class=chinese>中国</strong>安装、配置 Mac 的 Haskell 环境和编辑器的高亮、补全，其中编辑器包括 Vim/Neovim、Visual Studio Code。</p>
</blockquote>
<h2 id="安装-haskell">安装 Haskell</h2>
<blockquote>
<p>本文将带你安装 GHCup、GHC、Cabal。由于笔者写这篇文章时还是 Haskell 的初学者，所以没有办法细致的分析各种工具的优劣，故选择目前相对流行、配置简单的工具。</p>
</blockquote>
<p>要安装 Haskell，首先要打开一个 terminal，之后的操作都会基于 terminal 来完成。</p>
<p>第一步我们要安装 GHCup，由于这个软件比较新，所以较少有镜像，这里我们选择<a href="https://mirrors.ustc.edu.cn/help/ghcup.html">中科大的镜像网站</a>。但是由于 GHCup 在安装 Cabal 时会下载一个文件，所以我们必须提前替换 hackage 源，否则将无法正常安装。换源方法如下：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#080;font-style:italic"># 第一步在家目录下创建一个 .cabal 文件夹</span>
</span></span><span style="display:flex;"><span><span style="color:#a2f">cd</span> ~ <span style="color:#666">&amp;&amp;</span> mkdir .cabal
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># 第二步创建并编辑一个 config 文件</span>
</span></span><span style="display:flex;"><span>vi .cabal/config
</span></span></code></pre></div><p>这里我选择用 vim，你可以用 nano，vscode 等等编辑器，不会有任何影响，<del>当然，我不推荐你使用 emacs</del>。然后将如下内容粘贴进去，保存退出：</p>
<pre tabindex="0"><code>repository mirrors.ustc.edu.cn
  url: https://mirrors.ustc.edu.cn/hackage/
  secure: True
</code></pre><p>之后就可以在终端执行命令了：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>curl --proto <span style="color:#b44">&#39;=https&#39;</span> --tlsv1.2 -sSf https://mirrors.ustc.edu.cn/ghcup/sh/bootstrap-haskell | <span style="color:#b8860b">BOOTSTRAP_HASKELL_YAML</span><span style="color:#666">=</span>https://mirrors.ustc.edu.cn/ghcup/ghcup-metadata/ghcup-0.0.7.yaml sh
</span></span></code></pre></div><p>接下来你会看到这样的界面：</p>
<p><img alt="image-20230702042402797" src="https://cdn.jsdelivr.net/gh/zzxdyf1314/mycloudimg@master/image-20230702042402797.png"></p>
<p><strong>请仔细阅读所有提示，如果你不知道该做什么，就照我的选择去做：</strong></p>
<ol>
<li>是否自动将 ghcup 目录自动加入 PATH 直接回车</li>
<li>是否安装 haskell 的 lsp
<ul>
<li>如果你想使用 vscode 或 vim 等编辑器来补全、高亮、提示 Haskell 代码，就输入 Y；</li>
</ul>
</li>
<li>是否安装 Stack，输入 N，不安装。</li>
</ol>
<p>之后的选项都直接回车，就完成了 GHCup 的安装，这里你需要设置当前 shell 的 PATH：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#a2f">source</span> ~/.ghcup/env
</span></span></code></pre></div><p>如果你不想这样做，也可以直接重启你的 shell。</p>
<p>这时你的 Haskell 环境已经安装完成了，可以简单测试一下：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ghc --version
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cabal --version
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ghci
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># 输入 :q 以退出 ghci</span>
</span></span></code></pre></div><p>接下来的步骤是配置 GHCup 的源</p>
<p>编辑 <code>~/.ghcup/config.yaml</code>文件，向其中添加：</p>
<pre tabindex="0"><code>url-source:
    OwnSource: https://mirrors.ustc.edu.cn/ghcup/ghcup-metadata/ghcup-0.0.7.yaml
</code></pre><h2 id="编辑器配置">编辑器配置</h2>
<p>如果你想在 Vim/Neovim 上使用 HLS 来完成高亮、补全、提示、报错的话，你需要安装 <a href="https://github.com/neoclide/coc.nvim">Coc.nvim</a>，并安装<code>coc-hls</code>插件，可以直接在 vim 的 command 模式下输入<code>:CocInstall coc-hls</code>，之后就可以正常使用了（一定要保证你安装了 HLS）。</p>
<p>在 vscode 上搜索 Haskell，安装同名插件即可。</p>
<p>不管是在 vim 还是 vscode 上都可能出现一种情况，插件提示说找不到对应版本的 HLS，一般来说问题出在你安装的 GHC 还不支持你安装的 HLS，可以在终端输入：</p>
<pre tabindex="0"><code>ghcup tui
</code></pre><p>进入 ghcup 的 ui 界面：</p>
<p><img alt="image-20230702043610766" src="https://cdn.jsdelivr.net/gh/zzxdyf1314/mycloudimg@master/image-20230702043610766.png"></p>
<p>一定要保证你安装的 GHC 后面标有 hls-powered，你可以按上下键移动到对应的 GHC 版本上按<code>i</code>安装或按<code>u</code>卸载。同样的，你也可以安装或卸载其他的工具。</p>
<p>如果你是从这个界面安装的其他版本的 GHC，并卸掉了之前安装的，那么你需要替换掉原本的 ghc 文件和 ghci 文件，你可以在重启 shell 后发现 ghc 和 ghci 命令不存在或是还是原来的版本，这时你需要更新这两个文件。</p>
<p>ghc 和 ghci 的默认路径在家目录下的<code>.ghcup/bin/</code>下，是软连接到.ghcup/ghc/version code/bin/`下的文件，我们要做的就是重新软连接：</p>
<pre tabindex="0"><code>ln -s ~/.ghcup/ghc/verison code/bin ghci ~/.ghcup/bin/ghci
ln -s ~/.ghcup/ghc/verison code/bin ghc ~/.ghcup/bin/ghc
</code></pre><p>之后重启 shell/vscode，就会发现你的 HLS 已经可以运行了。</p>
<blockquote>
<p>如果最开始有短暂的卡顿，是 HLS 正在启动，稍等即可。</p>
</blockquote>
    
  </article>
  <div class="paginator">
    
    <a class="link" href="https://forceoflife.cn/zh-cn/post/talksomething/">← prev</a>
    
    
    <a class="link" href="https://forceoflife.cn/zh-cn/post/xdwydt/">next →</a>
    
  </div>
  <div class="comment">
    
    
    
    
      <script src="https://giscus.app/client.js"
        data-repo="forceofsystem/forceofsystem.github.io"
        data-repo-id="R_kgDOJn4OQw"
        data-category="Announcements"
        data-category-id="DIC_kwDOJn4OQ84CeqcH"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>

    
    
    
  </div>
  
</main>

    <footer id="footer">
  <div>
    <span>© 2023</span> - <span>2024</span>
  </div>

  <div>
    <span>Powered by </span>
    <a class="link" href="https://gohugo.io/">Hugo</a>
    <span> 🍦 Theme </span>
    <a class="link" href="https://github.com/forceofsystem/hugo-theme-texify">TeXify</a>
  </div>

  <div class="footnote">
    <span>Follow me on <a class=link href=https://github.com/forceofsystem>GitHub</a> |
<a class=link href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener>CC BY-NC-SA 4.0</a>
</span>
  </div>
</footer>

  </div>

  
  

  
  

  
  
  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-TZC1QJP9DV"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-TZC1QJP9DV');
        }
      </script>
    
  



</body>

</html>
